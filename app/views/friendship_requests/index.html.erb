<h1 class= "text-center block text-gray-700 text-sm font-bold mb-2">Friend Requests</h1>
<ul class="bg-white shadow-md rounded px-4 pt-3 pb-4 mb-2 divide-y divide-slate-200">
  <p class="text-center block text-gray-700 text-sm mb-2">Received:</p>
  <% @friendship_requests.each do |request| %>
    <% if request.request_recipient_id == current_user.id %>
    <li class="flex py-4 first:pt-0 last:pb-0">
      <% user = User.find(request.request_provider_id) %>
      <img class="h-10 w-10 rounded-full" src="https://www.nicepng.com/png/full/270-2709350_smiley-face-black-and-white-laughing-stick-figure.png" alt="Stick figure fage" />
      <div class=" ml-3 overflow-hidden">
        <div class="flex justify-center">
          <%= link_to user.username, user, class: "p-1 rounded text-sm font-medium text-slate-900 hover:bg-slate-500 hover:text-white" %>
        </div>
        <p class="text-sm text-slate-500 truncate"><%= user.email %></p>
      </div>

      <div>
        <%= link_to "Deny", friendship_request_path(request), data: {
              turbo_method: :delete,
              turbo_confirm: "Are you sure?"
            }, class: "hover:cursor-pointer bg-white hover:bg-gray-100 text-gray-800 font-semibold pt-1 py-1 px-1 rounded ml-1" %>

        <%= form_with model: Friendship.new do |form| %>
          <div>
            <%= form.hidden_field :friendship_recipient_id, value: user.id %>
          </div>

          <div>
            <%= form.hidden_field :friendship_provider_id, value: current_user.id %>
          </div>

          <%= form.fields_for :notifications, Notification.new do |notification_form| %>
            <% notification_message = "#{current_user.username} accepted your friendship request!"%>

            <%= notification_form.hidden_field :recipient_id, value: user.id %>
            
            <%= notification_form.hidden_field :body, value: notification_message %>
          <% end %>

          <div>
            <%= form.submit "Accept", class: "hover:cursor-pointer bg-white hover:bg-gray-100 text-gray-800 font-semibold pt-1 py-1 px-1 rounded ml-1"  %>
          </div>
        <% end %>
      </div>
    <% end %>
  <% end %>
</ul>

<ul class="bg-white shadow-md rounded px-4 pt-3 pb-4 mb-2 divide-y divide-slate-200">
  <p class="text-center block text-gray-700 text-sm mb-2">Sent:</p>
  <% @friendship_requests.each do |request| %>
    <% if request.request_provider_id == current_user.id %>

      <li class="flex py-4 first:pt-0 last:pb-0">
        <% user = User.find(request.request_recipient_id) %>
        <img class="h-10 w-10 rounded-full" src="https://www.nicepng.com/png/full/270-2709350_smiley-face-black-and-white-laughing-stick-figure.png" alt="Stick figure fage" />
        <div class=" ml-3 overflow-hidden">
          <div class="flex justify-center">
            <%= link_to user.username, user, class: "p-1 rounded text-sm font-medium text-slate-900 hover:bg-slate-500 hover:text-white" %>
          </div>
          <p class="text-sm text-slate-500 truncate"><%= user.email %></p>
        </div>

        <div>
          <%= link_to "Reject", friendship_request_path(request), data: {
                    turbo_method: :delete,
                    turbo_confirm: "Are you sure?"
                  }, class: "hover:cursor-pointer bg-slate-500 hover:bg-slate-800 text-white p-1 rounded focus:outline-none focus:shadow-outline" %>
        </div>
      </li>
    <% end %>
  <% end %>
</ul>

